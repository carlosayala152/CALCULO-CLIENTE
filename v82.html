<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>SISTEMA DE CORTE v82.0</title>

<style>
body{
    font-family:Segoe UI,Arial;
    background:#eef2f7;
    margin:0;
    padding:20px;
}
.container{
    max-width:1200px;
    margin:auto;
    background:#fff;
    border-radius:16px;
    padding:25px;
    box-shadow:0 20px 40px rgba(0,0,0,.15);
}

/* TOPO */
.header{
    background:linear-gradient(135deg,#0f172a,#020617);
    color:#fff;
    padding:20px;
    border-radius:12px;
    text-align:center;
}
.header img{
    width:90px;
    margin-bottom:10px;
}
.header input,.header select{
    padding:6px 10px;
    border-radius:6px;
    border:none;
    font-weight:bold;
}

/* BOT√ïES */
.controls{
    margin:20px 0;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
}
.controls button{
    background:#64748b;
    color:#fff;
    border:none;
    padding:8px 14px;
    border-radius:6px;
    font-weight:bold;
    cursor:pointer;
}

/* TABELA */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
}
th,td{
    border:1px solid #cbd5e1;
    padding:8px;
    text-align:center;
}
th{
    background:#1e293b;
    color:#fff;
    font-size:12px;
}

/* BOT√ïES GRANDES */
.btn-main{
    width:100%;
    margin:15px 0;
    padding:14px;
    font-size:18px;
    font-weight:bold;
    border:none;
    border-radius:10px;
    cursor:pointer;
}
.gerar{background:#10b981;color:#fff;}
.imprimir{background:#3b82f6;color:#fff;}

/* ENFESTOS */
.section{
    margin-top:35px;
}
.section-title{
    background:linear-gradient(135deg,#0ea5e9,#22c55e);
    color:#fff;
    padding:12px;
    border-radius:10px;
    font-weight:800;
}
.card{
    border:2px solid #0f172a;
    border-radius:12px;
    padding:15px;
    margin-top:15px;
    page-break-inside:avoid;
}
.card-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    font-weight:bold;
    margin-bottom:10px;
}
.ok{color:green;font-weight:bold;}
.bad{color:red;font-weight:bold;}

/* IMPRESS√ÉO */
@media print{
    .controls,.btn-main,.header input,.header select{display:none!important;}
    body:after{
        content:"SISTEMA DE C√ÅLCULO DE CORTE PRO";
        position:fixed;
        bottom:15px;
        left:0;
        right:0;
        text-align:center;
        font-size:12px;
        opacity:0.25;
        color:#16a34a;
    }
}
</style>
</head>

<body>
<div class="container">

<!-- CABE√áALHO -->
<div class="header">
<img src="SISTEMA%20DE%20CORTE%20PRO.png">
<h1>SISTEMA DE CORTE v82.0</h1>
L <input id="L" type="number" value="1.56" step="0.01">
√ÅREA
<select id="A">
<option value="0.50">Pequena - 0.50</option>
<option value="0.90" selected>M√©dia - 0.90</option>
<option value="1.30">Grande - 1.30</option>
<option value="1.60">Extra G - 1.60</option>
</select>
Mesa <input id="M" type="number" value="7">
</div>

<!-- CONTROLES -->
<div class="controls">
<button onclick="grade38()">GRADE 38-58</button>
<button onclick="gradeLetras()">GRADE LETRAS</button>
<button onclick="addLinha()">+ TAMANHO</button>
</div>

<!-- ENTRADA -->
<table>
<thead>
<tr><th>TAM</th><th>PEDIDO</th><th>A√á√ÉO</th></tr>
</thead>
<tbody id="entrada"></tbody>
</table>

<!-- BOT√ïES -->
<button class="btn-main gerar" onclick="gerar()">‚ö° GERAR ENFESTOS</button>
<button class="btn-main imprimir" onclick="window.print()">üñ® IMPRIMIR</button>

<!-- SA√çDA -->
<div id="saida"></div>

</div>

<script>
const entrada=document.getElementById("entrada");
const saida=document.getElementById("saida");

function addLinha(t="",q=""){
entrada.innerHTML+=`
<tr>
<td><input value="${t}"></td>
<td><input type="number" value="${q}"></td>
<td><button onclick="this.parentElement.parentElement.remove()">X</button></td>
</tr>`;
}

function grade38(){
entrada.innerHTML="";
[['38',20],['40',20],['42',20],['44',40],['46',30],['48',30],['50',30],['52',20],['54',20],['56',20],['58',20]]
.forEach(x=>addLinha(x[0],x[1]));
}
function gradeLetras(){
entrada.innerHTML="";
[['P',60],['M',160],['G',160],['GG',110]].forEach(x=>addLinha(x[0],x[1]));
}

function gerar(){
saida.innerHTML="";
let dados=[...entrada.querySelectorAll("tr")].map(r=>({
t:r.children[0].children[0].value,
q:+r.children[1].children[0].value
})).filter(x=>x.q>0);

if(!dados.length){
alert("Informe os pedidos.");
return;
}

let L=+document.getElementById("L").value;
let A=+document.getElementById("A").value;
let M=+document.getElementById("M").value;

/* OP√á√ÉO 1 */
saida.innerHTML+=`<div class="section"><div class="section-title">Op√ß√£o 1 ‚Äì Plano Geral</div></div>`;
criarEnfesto("ORDEM PADR√ÉO",dados);

/* OP√á√ÉO 2 */
saida.innerHTML+=`<div class="section"><div class="section-title">Op√ß√£o 2 ‚Äì Agrupamento</div></div>`;
dados.forEach(d=>criarEnfesto("ENFESTO "+d.t,[d]));

/* OP√á√ÉO 3 */
saida.innerHTML+=`<div class="section"><div class="section-title">Op√ß√£o 3 ‚Äì Afinidade de Pares</div></div>`;
let pares=[['M','G'],['GG','P']];
pares.forEach(p=>{
let a=dados.find(x=>x.t===p[0]);
let b=dados.find(x=>x.t===p[1]);
if(a&&b) criarEnfesto("OTIMIZADO "+a.t+" + "+b.t,[a,b]);
});
}

function criarEnfesto(titulo,itens){
let folhas=Math.min(...itens.map(i=>i.q));
let moldes=0;
let html=`<div class="card"><div class="card-header">${titulo} <span>FOLHAS ${folhas}</span></div>
<table><tr><th>TAM</th><th>PEDIDO</th><th>MOLDES</th><th>PROD</th><th>SALDO</th></tr>`;
itens.forEach(i=>{
let m=Math.max(1,Math.round(i.q/folhas));
let prod=m*folhas;
let saldo=prod-i.q;
moldes+=m;
html+=`<tr>
<td>${i.t}</td><td>${i.q}</td><td>${m}</td><td>${prod}</td>
<td class="${saldo>=0?'ok':'bad'}">${saldo>=0?'+':''}${saldo}</td>
</tr>`;
});
let risco=((moldes*+A.value)/+L.value).toFixed(2);
html+=`</table><div>RISCO ${risco}m | MESA ${risco<=+M.value?'‚úî':'‚ö† PASSA'}</div></div>`;
saida.innerHTML+=html;
}

gradeLetras();
</script>

</body>
</html>
