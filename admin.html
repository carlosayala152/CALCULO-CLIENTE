<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>ADMIN — SISTEMA DE CORTE PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:linear-gradient(135deg,#020617,#020617,#020617);
  color:#fff;
}
.top{
  text-align:center;
  padding:20px;
  font-weight:bold;
  font-size:20px;
}
.sub{
  font-size:13px;
  opacity:.7;
}
.box{
  max-width:900px;
  margin:20px auto;
  background:#020617cc;
  border-radius:16px;
  padding:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.6);
}
h3{
  margin-top:0;
}
input,select,button{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  margin-bottom:10px;
  font-size:15px;
}
button.save{
  background:#10b981;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button.cancel{
  background:#64748b;
  color:#fff;
  cursor:pointer;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border-bottom:1px solid #334155;
  padding:8px;
  text-align:center;
  font-size:14px;
}
th{
  opacity:.8;
}
.footer{
  text-align:center;
  font-size:12px;
  opacity:.6;
  margin-top:20px;
}
</style>
</head>

<body>

<div class="top">
  SISTEMA DE CORTE PRO<br>
  <span class="sub">Admin · by Carlos Daniel / DANI</span>
</div>

<div class="box">
  <h3>Criar Cliente</h3>

  <select id="status">
    <option value="ON">ON</option>
    <option value="OFF">OFF</option>
  </select>

  <input id="senha" placeholder="Senha do cliente">

  <input id="validade" type="date">

  <input id="cliente" placeholder="Nome do cliente">

  <select id="plano">
    <option value="MENSAL">MENSAL</option>
    <option value="ANUAL">ANUAL</option>
    <option value="VITALICIO">VITALÍCIO</option>
  </select>

  <button class="save" onclick="criarCliente()">Salvar</button>
  <button class="cancel" onclick="limpar()">Cancelar</button>
</div>

<div class="box">
  <h3>Clientes</h3>

  <table>
    <thead>
      <tr>
        <th>Status</th>
        <th>Cliente</th>
        <th>Senha</th>
        <th>Validade</th>
        <th>Plano</th>
      </tr>
    </thead>
    <tbody id="lista">
      <tr><td colspan="5">Carregando...</td></tr>
    </tbody>
  </table>
</div>

<div class="footer">
  by Carlos Daniel / DANI
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbzP1WYuEkNrGOpwtLQy8mdG9kcVO1Ue9WWjpITwBnp-suCrFZ2VpGwBmUQRXIu-Pcaa8Q/exec";

async function carregarClientes(){
  try{
    const r = await fetch(API + "?acao=listar");
    const dados = await r.json();

    const lista = document.getElementById("lista");
    lista.innerHTML = "";

    dados.forEach(c=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${c.status}</td>
        <td>${c.cliente}</td>
        <td>${c.senha}</td>
        <td>${c.validade}</td>
        <td>${c.plano}</td>
      `;
      lista.appendChild(tr);
    });

  }catch(e){
    document.getElementById("lista").innerHTML =
      "<tr><td colspan='5'>Erro ao carregar</td></tr>";
  }
}

async function criarCliente(){
  const status = statusEl().value;
  const senha = senhaEl().value;
  const validade = validadeEl().value;
  const cliente = clienteEl().value;
  const plano = planoEl().value;

  if(!senha || !validade || !cliente){
    alert("Preencha todos os campos");
    return;
  }

  const url = `${API}?acao=criar&status=${status}&senha=${senha}&validade=${validade}&cliente=${cliente}&plano=${plano}`;
  const r = await fetch(url);
  const j = await r.json();

  if(j.ok){
    alert("Cliente criado com sucesso");
    limpar();
    carregarClientes();
  }else{
    alert(j.erro || "Erro");
  }
}

function limpar(){
  senhaEl().value="";
  clienteEl().value="";
}

const statusEl=()=>document.getElementById("status");
const senhaEl=()=>document.getElementById("senha");
const validadeEl=()=>document.getElementById("validade");
const clienteEl=()=>document.getElementById("cliente");
const planoEl=()=>document.getElementById("plano");

window.onload = carregarClientes;
</script>

</body>
</html>
