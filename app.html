<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>SISTEMA DE CORTE PRO v82</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:linear-gradient(135deg,#020617,#0f172a);
  color:#e5e7eb;
}
header{
  background:#020617;
  padding:15px;
  text-align:center;
  font-weight:bold;
}
.container{
  max-width:1100px;
  margin:auto;
  padding:20px;
}
.card{
  background:#fff;
  color:#020617;
  border-radius:12px;
  padding:20px;
  margin-bottom:25px;
}
input,select,button{
  padding:10px;
  margin:5px 0;
}
button{
  cursor:pointer;
  border:none;
  border-radius:6px;
  font-weight:bold;
}
.btn-green{background:#10b981;color:#fff}
.btn-blue{background:#3b82f6;color:#fff}
.hidden{display:none}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid #cbd5e1;
  padding:8px;
  text-align:center;
}
th{background:#0f172a;color:#fff}
.opcao{
  border:2px solid #10b981;
  border-radius:10px;
  margin-top:20px;
}
.opcao h3{
  background:#10b981;
  color:#fff;
  margin:0;
  padding:10px;
  border-radius:8px 8px 0 0;
}
</style>
</head>

<body>

<header>
üîí SISTEMA DE CORTE PRO ‚Äî v82 ‚Ä¢ by Carlos-Daniel / DANI
</header>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <div class="card" style="max-width:400px;margin:auto">
    <h3>Digite sua senha</h3>
    <input id="senhaInput" placeholder="Senha">
    <button class="btn-green" onclick="login()">ENTRAR</button>
    <p id="loginMsg" style="color:red"></p>
  </div>
</div>

<!-- APP -->
<div class="container hidden" id="app">

  <div class="card">
    <b>Cliente:</b> <span id="cliente"></span> |
    <b>Plano:</b> <span id="plano"></span> |
    <b>Validade:</b> <span id="validade"></span>
    <button class="btn-blue" style="float:right" onclick="logout()">SAIR</button>
  </div>

  <div class="card">
    <h2>SISTEMA DE CORTE v82.0</h2>

    Largura (L):
    <input id="largura" type="number" value="1.56" step="0.01">

    Mesa:
    <input id="mesa" type="number" value="7">

    √Årea:
    <select id="area">
      <option value="0.9">M√©dias (0,90)</option>
      <option value="1.1">Grandes (1,10)</option>
    </select>

    <hr>

    <table id="tabela">
      <thead>
        <tr><th>TAM</th><th>QTD</th></tr>
      </thead>
      <tbody>
        <tr><td>P</td><td><input value="60"></td></tr>
        <tr><td>M</td><td><input value="160"></td></tr>
        <tr><td>G</td><td><input value="160"></td></tr>
        <tr><td>GG</td><td><input value="110"></td></tr>
      </tbody>
    </table>

    <br>
    <button class="btn-green" onclick="gerar()">‚ö° GERAR ENFESTOS</button>
    <button class="btn-blue" onclick="window.print()">üñ® IMPRIMIR</button>
  </div>

  <!-- OP√á√ÉO 1 -->
  <div class="opcao" id="op1">
    <h3>OP√á√ÉO 1 ‚Äî ENFESTO PRINCIPAL</h3>
    <div class="card" id="res1"></div>
  </div>

  <!-- OP√á√ÉO 2 -->
  <div class="opcao" id="op2">
    <h3>OP√á√ÉO 2 ‚Äî AGRUPAMENTO OTIMIZADO</h3>
    <div class="card" id="res2"></div>
  </div>

  <!-- OP√á√ÉO 3 -->
  <div class="opcao" id="op3">
    <h3>OP√á√ÉO 3 ‚Äî DIVIS√ÉO POR LOTES</h3>
    <div class="card" id="res3"></div>
  </div>

</div>

<script>
// ================= CONFIG =================
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTuSmsymsS19AqaRjVWOlcRA2FfU4yanFPiTFIvp4_VPyxm3vFF0i0ocZAY7hoe1XzfwP0wslP2dKWR/pub?output=csv";

// ================= LOGIN =================
async function login(){
  const senha = senhaInput.value.trim();
  const r = await fetch(CSV_URL);
  const t = await r.text();
  const linhas = t.split("\n").map(l=>l.split(","));

  const lic = linhas.find(l=>l[1]===senha);

  if(!lic || lic[0]!=="ON"){
    loginMsg.innerText="Senha inv√°lida ou bloqueada";
    return;
  }

  cliente.innerText = lic[4];
  plano.innerText = lic[5];
  validade.innerText = lic[2];

  loginBox.classList.add("hidden");
  app.classList.remove("hidden");
}

function logout(){
  location.reload();
}

// ================= V82 L√ìGICA =================
function gerar(){
  const linhas = [...document.querySelectorAll("#tabela tbody tr")];
  const dados = linhas.map(l=>{
    return {
      tam:l.children[0].innerText,
      qtd:parseInt(l.children[1].children[0].value)
    }
  });

  // OP√á√ÉO 1
  res1.innerHTML = gerarTabela(dados,1);

  // OP√á√ÉO 2
  res2.innerHTML = gerarTabela(dados,2);

  // OP√á√ÉO 3
  res3.innerHTML = gerarTabela(dados,3);
}

function gerarTabela(dados,mult){
  let html="<table><tr><th>TAM</th><th>QTD</th><th>MLD</th><th>TOTAL</th></tr>";
  dados.forEach(d=>{
    const mld = Math.max(1,Math.floor(d.qtd/(20*mult)));
    html+=`<tr>
      <td>${d.tam}</td>
      <td>${d.qtd}</td>
      <td>${mld}</td>
      <td>${mld*20}</td>
    </tr>`;
  });
  html+="</table>";
  return html;
}
</script>

</body>
</html>
